<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ—Å—Ç—Ä–æ–π–∫–∏ BTTR</title>
    <link rel="icon" type="image/png" href="../../../asset/logo/pixels.png">

    <!-- –®—Ä–∏—Ñ—Ç Minecraft -->
    <style>
        @font-face{
            font-family:'Minecraft';
            src:url('../../../fonts/minecraft.ttf') format('truetype');
        }
        :root{
            --accent:#ffcc00;
            --accent-rgb:255,204,0;
            --bg-primary:#0a0a0a;
            --bg-card:rgba(50,50,50,.5);
            --bg-header:rgba(0,0,0,.6);
            --bg-overlay:rgba(0,0,0,.7);
            --border:#666;
            --text-primary:#fff;
            --text-secondary:#ddd;
            --focus:#ffcc00;
            --grid-gap:1.5rem;
            --font-main:'Minecraft',sans-serif;
        }
        *{margin:0;padding:0;box-sizing:border-box}
        html{scroll-behavior:smooth}
        body{
            font-family:var(--font-main);
            background:var(--bg-primary);
            color:var(--text-primary);
            min-height:100vh;
        }
        .background-overlay{
            position:fixed;top:0;left:0;width:100%;height:100%;
            background:rgba(0,0,0,.7);
            z-index:-1;
        }

        /* ---------- –®–∞–ø–∫–∞ ---------- */
        .container{
            max-width:1400px;
            margin:0 auto;
            padding:20px;
        }
        .header{
            text-align:center;
            margin-bottom:30px;
            padding:20px;
            background:var(--bg-header);
            border-radius:15px;
            border:2px solid #444;
        }
        .header h1{
            font-size:48px;
            color:var(--accent);
            text-shadow:3px 3px 6px rgba(0,0,0,.8);
        }

        /* ---------- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ---------- */
        .controls{
            display:flex;
            flex-wrap:wrap;
            justify-content:space-between;
            align-items:center;
            gap:1rem;
            margin-bottom:var(--grid-gap);
        }
        .stats{font-size:1.125rem;color:var(--accent);}
        .filters{
            display:flex;
            gap:.5rem;
            flex-wrap:wrap;
        }
        .filter-btn{
            background:var(--bg-card);
            color:var(--text-primary);
            border:2px solid var(--border);
            padding:.5rem 1rem;
            border-radius:6px;
            cursor:pointer;
            transition:.3s;
        }
        .filter-btn:hover,
        .filter-btn:focus-visible,
        .filter-btn.active{
            background:var(--accent);
            color:var(--bg-primary);
            border-color:var(--accent);
        }
        .search{
            position:relative;
            flex:1 1 260px;
            max-width:600px;
        }
        .search input{
            width:100%;
            padding:.9rem 1.2rem;
            background:#222;
            border:3px solid var(--border);
            border-radius:10px;
            color:var(--text-primary);
            font-size:1rem;
            outline:none;
            transition:.3s;
        }
        .search input:focus{
            border-color:var(--accent);
            box-shadow:0 0 10px rgba(var(--accent-rgb),.5);
        }

        /* ---------- –°–µ—Ç–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–∫ ---------- */
        .grid{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(350px,1fr));
            gap:var(--grid-gap);
        }
        .card{
            background:var(--bg-card);
            border:1px solid var(--border);
            border-radius:12px;
            padding:1.25rem;
            position:relative;
            overflow:hidden;
            transition:.3s;
            outline:none;
        }
        .card:hover,
        .card:focus-within{
            transform:translateY(-5px);
            border-color:var(--accent);
            box-shadow:0 10px 20px rgba(var(--accent-rgb),.2);
        }
        .card::before{
            content:"";
            position:absolute;top:0;left:0;right:0;height:3px;
            background:var(--accent);
            transform:scaleX(0);
            transition:.3s;
        }
        .card:hover::before,
        .card:focus-within::before{transform:scaleX(1);}

        .card-header{
            display:flex;
            align-items:center;
            margin-bottom:1rem;
            padding-bottom:.75rem;
            border-bottom:1px solid var(--border);
        }
        .icon{
            flex-shrink:0;
            width:60px;height:60px;
            background:#333;
            border:2px solid var(--accent);
            border-radius:8px;
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:1.75rem;
            margin-right:.75rem;
            color:var(--accent);
        }
        .title{
            font-size:1.375rem;
            color:var(--accent);
            margin:0;
        }
        .coords{
            background:rgba(var(--accent-rgb),.1);
            color:var(--accent);
            padding:.4rem .8rem;
            border-radius:.5rem;
            border:1px solid rgba(var(--accent-rgb),.3);
            display:inline-flex;
            align-items:center;
            gap:.5rem;
            font-size:.875rem;
            margin-bottom:.75rem;
        }
        .copy-coords{
            background:transparent;
            border:none;
            color:var(--accent);
            cursor:pointer;
            font-size:1rem;
        }
        .copy-coords:hover,
        .copy-coords:focus-visible{color:#fff;}

        .image{
            position:relative;
            margin:.75rem 0;
            cursor:pointer;
            border:2px solid #555;
            border-radius:.5rem;
            overflow:hidden;
        }
        .image img{
            width:100%;height:200px;object-fit:cover;
            transition:.3s;
        }
        .image:hover img,
        .image:focus-within img{transform:scale(1.05);}
        .overlay{
            position:absolute;inset:0;
            background:var(--bg-overlay);
            color:var(--text-primary);
            display:flex;align-items:center;justify-content:center;
            opacity:0;
            transition:.3s;
        }
        .image:hover .overlay,
        .image:focus-within .overlay{opacity:1;}
        .description{
            font-size:.9375rem;
            color:var(--text-secondary);
            margin:.75rem 0;
        }
        .players{
            margin-top:.75rem;
            padding-top:.75rem;
            border-top:1px solid var(--border);
        }
        .players-title{
            font-size:.9375rem;
            color:var(--accent);
            margin-bottom:.5rem;
        }
        .players-list{
            list-style:none;
            display:flex;
            flex-wrap:wrap;
            gap:.5rem;
        }
        .player-item{
            display:flex;
            align-items:center;
        }
        .player-avatar{
            width:24px;height:24px;
            border-radius:4px;
            margin-right:.5rem;
            flex-shrink:0;
        }
        .player-link{
            background:rgba(100,100,100,.5);
            color:var(--text-primary);
            padding:.4rem .75rem;
            border-radius:15px;
            text-decoration:none;
            font-size:.8125rem;
            border:1px solid #666;
            transition:.3s;
        }
        .player-link:hover,
        .player-link:focus-visible{
            background:var(--accent);
            color:var(--bg-primary);
            border-color:var(--accent);
        }

        .no-results{
            grid-column:1/-1;
            background:var(--bg-card);
            border:2px solid var(--border);
            border-radius:12px;
            padding:2rem;
            text-align:center;
            font-size:1.25rem;
            color:var(--accent);
        }

        /* ---------- Lightbox ---------- */
        .lightbox{
            display:none;
            position:fixed;
            inset:0;
            background:rgba(0,0,0,.9);
            z-index:1000;
            overflow:auto;
            padding-top:2rem;
        }
        .lightbox[aria-hidden="false"]{
            display:flex;
            justify-content:center;
            align-items:start;
        }
        .lb-content{
            position:relative;
            max-width:90%;
            width:800px;
        }
        .lb-content img{
            width:100%;height:auto;
            border-radius:.75rem;
            box-shadow:0 0 20px rgba(var(--accent-rgb),.3);
        }
        .close-btn{
            position:absolute;
            top:1rem;right:1rem;
            background:transparent;
            border:none;
            color:var(--text-primary);
            font-size:2rem;
            cursor:pointer;
            text-shadow:0 0 5px #000;
        }
        .close-btn:hover,
        .close-btn:focus-visible{color:var(--accent);}
        .nav{
            position:absolute;
            top:50%;transform:translateY(-50%);
            background:rgba(0,0,0,.5);
            color:#fff;
            border:none;
            padding:.75rem 1rem;
            font-size:1.25rem;
            cursor:pointer;
            border-radius:.3rem;
            transition:.3s;
        }
        .nav:hover,
        .nav:focus-visible{background:rgba(var(--accent-rgb),.8);}
        .prev{left:1rem;}
        .next{right:1rem;}
        .counter{
            position:absolute;
            top:1rem;left:1rem;
            color:#fff;
            font-size:1rem;
            text-shadow:0 0 5px #000;
        }
        .thumbs{
            display:flex;
            gap:.5rem;
            margin-top:1rem;
            overflow-x:auto;
            padding:.5rem 0;
        }
        .thumb{
            width:60px;height:60px;
            border:2px solid transparent;
            border-radius:.3rem;
            overflow:hidden;
            cursor:pointer;
            transition:.3s;
            flex-shrink:0;
        }
        .thumb:hover,
        .thumb:focus-visible,
        .thumb.active{
            border-color:var(--accent);
            transform:scale(1.08);
        }
        .thumb img{
            width:100%;height:100%;object-fit:cover;
        }

        .back-button{
            display:block;
            margin:30px auto;
            background:var(--accent);
            color:#000;
            border:none;
            padding:15px 30px;
            font-family:var(--font-main);
            font-size:18px;
            border-radius:10px;
            cursor:pointer;
            text-align:center;
            max-width:200px;
            text-decoration:none;
            transition:.3s;
        }
        .back-button:hover{
            background:#ffd700;
            transform:scale(1.05);
            box-shadow:0 0 15px rgba(255,204,0,.8);
        }

        @media (max-width:768px){
            .grid{grid-template-columns:1fr;}
            .header h1{font-size:2.2rem;}
            .card-header{flex-direction:column;text-align:center;}
            .icon{margin-right:0;margin-bottom:.5rem;}
            .controls{flex-direction:column;align-items:stretch;}
        }
        @media (prefers-reduced-motion:reduce){
            *{transition:none!important;}
        }
        :focus-visible{
            outline:3px solid var(--focus);
            outline-offset:2px;
        }
    </style>
</head>
<body>
    <!-- –¢—ë–º–Ω—ã–π –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π (–∫–∞–∫ —É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü) -->
    <div class="background-overlay"></div>

    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <h1>–ü–æ—Å—Ç—Ä–æ–π–∫–∏ BTTR</h1>
        </header>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <section class="controls" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º">
            <div class="stats">
                –í—Å–µ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–∫: <span id="total-count">0</span>
            </div>
            <nav class="filters" role="group" aria-label="–§–∏–ª—å—Ç—Ä—ã –ø–æ—Å—Ç—Ä–æ–µ–∫">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="main">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</button>
                <button class="filter-btn" data-filter="home">–î–æ–º–∞</button>
                <button class="filter-btn" data-filter="other">–î—Ä—É–≥–æ–µ</button>
            </nav>
            <div class="search">
                <label for="search-input" class="visually-hidden">–ü–æ–∏—Å–∫ –ø–æ—Å—Ç—Ä–æ–µ–∫</label>
                <input type="search" id="search-input"
                       placeholder="–ü–æ–∏—Å–∫ –ø–æ—Å—Ç—Ä–æ–µ–∫..."
                       autocomplete="off"
                       aria-label="–ü–æ–∏—Å–∫ –ø–æ—Å—Ç—Ä–æ–µ–∫">
            </div>
        </section>

        <!-- –°–µ—Ç–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–∫ -->
        <section id="buildings" class="grid" aria-live="polite"></section>

        <p id="no-results" class="no-results" hidden>–ï—â—ë –Ω–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ!</p>

        <!-- –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞–∑–∞–¥ –∫ –∫–ª–∞–Ω–∞–º¬ª (–∫–∞–∫ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–∞—Ö) -->
        <a href="../index.html" class="back-button">–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
    </div>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox" role="dialog"
         aria-modal="true" aria-hidden="true" aria-label="–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π">
        <button class="close-btn" aria-label="–ó–∞–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é">&times;</button>
        <div class="lb-content">
            <img id="lb-img" src="" alt="">
            <button class="nav prev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">&#9664;</button>
            <button class="nav next" aria-label="–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">&#9654;</button>
            <div class="counter" id="lb-counter"></div>
            <div class="thumbs" id="lb-thumbs"></div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç -->
    <script>
        /* --------- –î–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—Ä–æ–µ–∫ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ --------- */
        const buildings = [
            {
                name: "–ö–∏—Ä–ø–∏—á–Ω–∞—è –ü–ª–æ—â–∞–¥—å",
                type: "main",
                icon: "üè∞",
                coords: {},
                description: "—Å–ø–∞–≤–Ω –≥–¥–µ –≤—Å–µ –ø—É—Ç–∏ —Å–∫—Ä–µ—â–∞—é—Ç—Å—è —Å –¥–æ–º–∞–º–∏ –∏ —Å –∫–ª–∞–Ω–æ–º –∞—Å—Å–∏—Ä–∏–∏",
                players: [
                    {name:"Dachentank", link:"#"},
                    {name:"FLEKSIY", link:"../admin.html"}
                ],
                images: [
                    "../../../asset/screns/hugedata/2026-02-08_19.05.24.png",
                    "../../../asset/screns/hugedata/2026-02-08_19.05.31.png",
                    "../../../asset/screns/hugedata/2026-02-08_19.05.16.png"
                ]
            },
            {
                name: "–ö–æ–±–ª-–ø–∏—Ä–∞–º–∏–¥–∞",
                type: "main",
                icon: "‚õèÔ∏è",
                coords: {x:666, y:666, z:66},
                description: "–ë–æ–ª—å—à–∞—è –ø–∏—Ä–∞–º–∏–¥–∞ —Å–¥–µ–ª–∞–Ω–∞—è –¥–≤—É–º—è –∏–≥—Ä–æ–∫–∞–º–∏. –ü–æ –∏–¥–µ–∏ –¢–æ–π —Å–∞–º–æ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ –∫–∏—Ä–ø–∏—á–Ω—ã–µ –ø–∏—Ä–∞–º–∏–¥—ã 1024x1024 –Ω–æ –ø–æ–º–µ–Ω—å—à–µ",
                players: [
                    {name:"zakap", link:"#"},
                    {name:"astolfo", link:"#"}
                ],
                images: [
                    "../../../asset/screns/hugedata/2026-02-16_20.27.20.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.26.38.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.27.41.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.27.53.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.28.04.png"
                ]
            },
            {
                name: "–ü–æ–¥–∑–µ–º–Ω—ã–π –≥–æ—Ä–æ–¥–æ–∫",
                type: "home",
                icon: "üó∫Ô∏è",
                coords: {},
                description: "–ì–æ—Ä–æ–¥–æ–∫ –°–¥–µ–ª–∞–Ω—ã–π komithepotion –≥–¥–µ —É –Ω–µ–≥–æ –µ—Å—Ç—å –±–æ–ª—å—à–æ–π —Å–∫–ª–∞–¥",
                players: [
                    {name:"komithepotion", link:"#"}
                ],
                images: [
                    "../../../asset/screns/hugedata/2026-02-16_20.30.40.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.30.56.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.31.05.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.31.36.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.31.41.png",
                    "../../../asset/screns/hugedata/2026-02-16_20.31.56.png"
                ]
            }
        ];

        /* ---------- UI —ç–ª–µ–º–µ–Ω—Ç—ã ---------- */
        const grid           = document.getElementById('buildings');
        const totalCount     = document.getElementById('total-count');
        const searchInput    = document.getElementById('search-input');
        const filterBtns     = document.querySelectorAll('.filter-btn');
        const noResults      = document.getElementById('no-results');

        const lightbox       = document.getElementById('lightbox');
        const lbImg          = document.getElementById('lb-img');
        const lbCloseBtn     = lightbox.querySelector('.close-btn');
        const lbPrevBtn      = lightbox.querySelector('.prev');
        const lbNextBtn      = lightbox.querySelector('.next');
        const lbCounter      = document.getElementById('lb-counter');
        const lbThumbs       = document.getElementById('lb-thumbs');

        let currentBuilding = null;
        let currentImgIdx   = 0;
        let activeFilter    = 'all';
        let debounceTimer   = null;

        /* ---------- –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ ---------- */
        function renderCards(){
            const frag = document.createDocumentFragment();

            buildings.forEach((b,i)=>{
                const card = document.createElement('article');
                card.className = 'card';
                card.dataset.type  = b.type;
                card.dataset.name  = b.name;
                card.dataset.index = i;
                card.tabIndex = 0;

                // Header (–∏–∫–æ–Ω–∫–∞ + –Ω–∞–∑–≤–∞–Ω–∏–µ)
                const header = document.createElement('header');
                header.className = 'card-header';
                const icon = document.createElement('div');
                icon.className = 'icon';
                icon.setAttribute('aria-hidden','true');
                icon.textContent = b.icon;
                const title = document.createElement('h2');
                title.className = 'title';
                title.textContent = b.name;
                header.append(icon,title);
                card.appendChild(header);

                // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã + –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                const coords = document.createElement('div');
                coords.className = 'coords';
                const code = document.createElement('code');
                code.textContent = `x=${b.coords.x}, y=${b.coords.y}, z=${b.coords.z}`;
                const copyBtn = document.createElement('button');
                copyBtn.className = 'copy-coords';
                copyBtn.type = 'button';
                copyBtn.setAttribute('aria-label','–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã');
                copyBtn.textContent = '¬©';
                coords.append(code,copyBtn);
                card.appendChild(coords);

                // –ì–ª–∞–≤–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≥–∞–ª–µ—Ä–µ—é)
                const figure = document.createElement('figure');
                figure.className = 'image';
                figure.tabIndex = 0;
                figure.setAttribute('role','button');
                figure.setAttribute('aria-label',`–û—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é ${b.name}`);
                figure.dataset.index = i;
                const img = document.createElement('img');
                img.src = b.images[0];
                img.alt = `${b.name} ‚Äì –ø—Ä–µ–≤—å—é`;
                img.loading = 'lazy';
                const overlay = document.createElement('div');
                overlay.className = 'overlay';
                overlay.innerHTML = `<span>¬∫ ${b.images.length} —Ñ–æ—Ç–æ</span>`;
                figure.append(img,overlay);
                card.appendChild(figure);

                // –û–ø–∏—Å–∞–Ω–∏–µ
                const desc = document.createElement('p');
                desc.className = 'description';
                desc.textContent = b.description;
                card.appendChild(desc);

                // –ò–≥—Ä–æ–∫–∏‚Äë—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏
                const playersSec = document.createElement('section');
                playersSec.className = 'players';
                const playersTitle = document.createElement('h4');
                playersTitle.className = 'players-title';
                playersTitle.textContent = '–°–¢–†–û–ò–¢–ï–õ–ò:';
                const playersList = document.createElement('ul');
                playersList.className = 'players-list';
                b.players.forEach(p=>{
                    const li = document.createElement('li');
                    li.className = 'player-item';
                    const avatar = document.createElement('img');
                    avatar.className = 'player-avatar';
                    avatar.src = `https://mineskin.eu/helm/${p.name.toLowerCase()}`;
                    avatar.alt = `${p.name} avatar`;
                    const link = document.createElement('a');
                    link.className = 'player-link';
                    link.href = p.link;
                    link.textContent = p.name;
                    li.append(avatar,link);
                    playersList.appendChild(li);
                });
                playersSec.append(playersTitle,playersList);
                card.appendChild(playersSec);

                frag.appendChild(card);
            });

            grid.appendChild(frag);
            totalCount.textContent = buildings.length;
        }

        /* ---------- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ ---------- */
        function applyFilters(){
            const term = searchInput.value.trim().toLowerCase();
            let visible = 0;

            document.querySelectorAll('.card').forEach(card=>{
                const typeMatch = activeFilter === 'all' || card.dataset.type===activeFilter;
                const name = card.dataset.name.toLowerCase();
                const desc = card.querySelector('.description').textContent.toLowerCase();
                const playerNames = Array.from(card.querySelectorAll('.player-link')).map(a=>a.textContent.toLowerCase());

                const textMatch = term==='' ||
                                  name.includes(term) ||
                                  desc.includes(term) ||
                                  playerNames.some(p=>p.includes(term));

                const show = typeMatch && textMatch;
                card.style.display = show ? '' : 'none';
                if(show) visible++;
            });

            totalCount.textContent = visible;
            noResults.hidden = visible!==0;
        }

        filterBtns.forEach(btn=>{
            btn.addEventListener('click',()=>{
                filterBtns.forEach(b=>b.classList.remove('active'));
                btn.classList.add('active');
                activeFilter = btn.dataset.filter;
                applyFilters();
            });
        });

        searchInput.addEventListener('input',()=>{
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(applyFilters,250);
        });

        /* ---------- Lightbox ---------- */
        function openLightbox(buildingIdx){
            currentBuilding = buildings[buildingIdx];
            currentImgIdx = 0;
            updateLightbox();
            lightbox.setAttribute('aria-hidden','false');
            document.body.style.overflow='hidden';
        }
        function closeLightbox(){
            lightbox.setAttribute('aria-hidden','true');
            document.body.style.overflow='';
        }
        function updateLightbox(){
            const src = currentBuilding.images[currentImgIdx];
            lbImg.src = src;
            lbImg.alt = `${currentBuilding.name} ${currentImgIdx+1}`;
            lbCounter.textContent = `${currentImgIdx+1} / ${currentBuilding.images.length}`;
            renderThumbs();
        }
        function renderThumbs(){
            lbThumbs.innerHTML = '';
            currentBuilding.images.forEach((src,i)=>{
                const btn = document.createElement('button');
                btn.className = 'thumb' + (i===currentImgIdx ? ' active' : '');
                btn.type = 'button';
                btn.setAttribute('aria-label',`–ú–∏–Ω–∏–∞—Ç—é—Ä–∞ ${i+1}`);
                btn.innerHTML = `<img src="${src.replace('800x500','100x100')}" alt="–ú–∏–Ω–∏–∞—Ç—é—Ä–∞ ${i+1}">`;
                btn.addEventListener('click',()=>{ currentImgIdx=i; updateLightbox(); });
                lbThumbs.appendChild(btn);
            });
        }
        function changeImg(step){
            const total = currentBuilding.images.length;
            currentImgIdx = (currentImgIdx + step + total) % total;
            updateLightbox();
        }

        // –ö–ª–∏–∫ –ø–æ –ø—Ä–µ–≤—å—é
        grid.addEventListener('click',e=>{
            const fig = e.target.closest('.image');
            if(fig){
                openLightbox(Number(fig.dataset.index));
                return;
            }
            // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            if(e.target.classList.contains('copy-coords')){
                const code = e.target.closest('.coords').querySelector('code');
                const txt = code.textContent;
                navigator.clipboard.writeText(txt).then(()=>{
                    const orig = e.target.textContent;
                    e.target.textContent = '‚úÖ';
                    setTimeout(()=>e.target.textContent=orig,1500);
                }).catch(()=>alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å'));
                e.stopPropagation();
            }
        });

        // –û—Ç–∫—Ä—ã—Ç–∏–µ Lightbox –∫–ª–∞–≤–∏—à–∞–º–∏ Enter/Space
        grid.addEventListener('keydown',e=>{
            if(e.key==='Enter' || e.key===' '){
                const fig = e.target.closest('.image');
                if(fig){
                    openLightbox(Number(fig.dataset.index));
                    e.preventDefault();
                }
            }
        });

        lbCloseBtn.addEventListener('click',closeLightbox);
        lbPrevBtn.addEventListener('click',()=>changeImg(-1));
        lbNextBtn.addEventListener('click',()=>changeImg(1));

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Lightbox –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
        document.addEventListener('keydown',e=>{
            if(lightbox.getAttribute('aria-hidden')==='false'){
                if(e.key==='Escape') closeLightbox();
                if(e.key==='ArrowLeft') changeImg(-1);
                if(e.key==='ArrowRight') changeImg(1);
            }
        });
        // –ó–∞–∫—Ä—ã—Ç—å —â–µ–ª—á–∫–æ–º –ø–æ –∑–∞—Ç–µ–º–Ω—ë–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
        lightbox.addEventListener('click',e=>{
            if(e.target===lightbox) closeLightbox();
        });

        /* ---------- –§–æ–Ω–æ–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ (–∫–∞–∫ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö) ---------- */
        const backgrounds = [
            '../../../asset/bg.png',
            '../../../asset/bg1.png',
            '../../../asset/screns/baza.png',
            '../../../asset/alone.png',
            '../../../asset/where.png'
        ];
        function getRandomBackground(){
            return backgrounds[Math.floor(Math.random()*backgrounds.length)];
        }
        document.addEventListener('DOMContentLoaded',()=>{
            // —Ñ–æ–Ω
            document.body.style.backgroundImage = `url('${getRandomBackground()}')`;
            // —Ä–µ–Ω–¥–µ—Ä–∏–º –∫–∞—Ä—Ç–æ—á–∫–∏
            renderCards();
            // –Ω–µ–±–æ–ª—å—à–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            document.querySelectorAll('.card').forEach((c,i)=>{
                c.style.opacity = 0;
                c.style.transform = 'translateY(20px)';
                setTimeout(()=>{
                    c.style.transition = 'all .5s ease';
                    c.style.opacity = 1;
                    c.style.transform = 'translateY(0)';
                }, i*100);
            });
        });
    </script>
</body>
</html>
