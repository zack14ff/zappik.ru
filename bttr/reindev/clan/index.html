<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ç–∞–ª–æ–≥ –ø–æ—Å—Ç—Ä–æ–µ–∫ ‚Äì BTTR</title>
    <meta name="description"
          content="–ö–∞—Ç–∞–ª–æ–≥ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ä–≤–µ—Ä–∞ BTTR: –∑–∞–º–∫–∏, —Ñ–µ—Ä–º—ã, —à–∞—Ö—Ç—ã –∏ –¥—Ä—É–≥–∏–µ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è —Å –≥–∞–ª–µ—Ä–µ–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.">
    <!-- ---------- –®—Ä–∏—Ñ—Ç—ã ---------- -->
    <link rel="preload"
          href="../../../fonts/minecraft.ttf"
          as="font"
          type="font/ttf"
          crossorigin>

    <style>
        /* -------------------- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Ç—ë–º–Ω–∞—è —Ç–µ–º–∞) -------------------- */
        :root{
            --bg-primary   : #0a0a0a;
            --bg-card      : rgba(30,30,30,.9);
            --bg-header    : rgba(0,0,0,.7);
            --bg-overlay   : rgba(0,0,0,.5);
            --border       : #444;
            --accent       : #ffcc00;
            --accent-rgb   : 255,204,0;
            --text-primary : #fff;
            --text-secondary: #ddd;
            --focus        : #ffcc00;
            --grid-gap     : 1.5rem;
            --font-main    : 'Arial', sans-serif;
        }

        @font-face{
            font-family:'Minecraft';
            src:url('./fonts/minecraft.ttf') format('truetype');
            font-display:swap;
        }

        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
        html{scroll-behavior:smooth}
        body{
            font-family:var(--font-main);
            background:var(--bg-primary);
            color:var(--text-primary);
            min-height:100vh;
            line-height:1.5;
            background-image:
                linear-gradient(rgba(0,20,0,.3) 1px,transparent 1px),
                linear-gradient(90deg,rgba(0,20,0,.3) 1px,transparent 1px);
            background-size:30px 30px;
        }
        .visually-hidden{
            position:absolute !important;
            width:1px;height:1px;
            padding:0;margin:-1px;
            overflow:hidden;clip:rect(0,0,0,0);
            white-space:nowrap;border:0;
        }

        /* -------------------- –®–∞–ø–∫–∞ -------------------- */
        header{
            text-align:center;
            padding:2rem 0;
            margin-bottom:2rem;
            background:var(--bg-header);
            border:3px solid var(--border);
            border-radius:15px;
        }
        header h1{
            font-size:2.8rem;
            color:var(--accent);
            text-shadow:3px 3px 0 #000;
            margin-bottom:.5rem;
        }
        header p{font-size:1rem;color:var(--text-secondary);}

        /* -------------------- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -------------------- */
        .controls{
            display:flex;
            flex-wrap:wrap;
            justify-content:space-between;
            align-items:center;
            gap:1rem;
            margin-bottom:var(--grid-gap);
        }
        .stats{font-size:1.125rem;color:var(--accent);}
        .filters{
            display:flex;
            gap:.5rem;
            flex-wrap:wrap;
        }
        .filter-btn{
            background:var(--bg-card);
            color:var(--text-primary);
            border:2px solid var(--border);
            padding:.5rem 1rem;
            font-family:var(--font-main);
            cursor:pointer;
            border-radius:6px;
            transition:background .3s,color .3s,border-color .3s;
        }
        .filter-btn:hover,
        .filter-btn:focus-visible,
        .filter-btn.active{
            background:var(--accent);
            color:var(--bg-primary);
            border-color:var(--accent);
        }
        .search{
            position:relative;
            flex:1 1 260px;
            max-width:600px;
        }
        .search input{
            width:100%;
            padding:.9rem 1.2rem;
            font-family:var(--font-main);
            font-size:1rem;
            background:#222;
            border:3px solid var(--border);
            border-radius:10px;
            color:var(--text-primary);
            outline:none;
            transition:border-color .3s,box-shadow .3s;
        }
        .search input:focus{
            border-color:var(--accent);
            box-shadow:0 0 10px rgba(var(--accent-rgb),.5);
        }

        /* -------------------- –°–µ—Ç–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–∫ -------------------- */
        .grid{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(350px,1fr));
            gap:var(--grid-gap);
        }
        .card{
            background:var(--bg-card);
            border:2px solid var(--border);
            border-radius:12px;
            padding:1.25rem;
            position:relative;
            overflow:hidden;
            transition:transform .3s,border-color .3s,box-shadow .3s;
            outline:none;
        }
        .card:hover,
        .card:focus-within{
            transform:translateY(-5px);
            border-color:var(--accent);
            box-shadow:0 10px 20px rgba(var(--accent-rgb),.2);
        }
        .card::before{
            content:"";
            position:absolute;top:0;left:0;right:0;height:3px;
            background:var(--accent);
            transform:scaleX(0);
            transition:transform .3s;
        }
        .card:hover::before,
        .card:focus-within::before{transform:scaleX(1);}

        .card-header{
            display:flex;
            align-items:center;
            margin-bottom:1rem;
            padding-bottom:.75rem;
            border-bottom:1px solid var(--border);
        }
        .icon{
            flex-shrink:0;
            width:60px;height:60px;
            background:#333;
            border:2px solid var(--accent);
            border-radius:8px;
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:1.75rem;
            margin-right:.75rem;
        }
        .title{
            font-size:1.375rem;
            color:var(--accent);
            margin:0;
        }

        /* ---- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã + –∫–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è ---- */
        .coords{
            background:rgba(var(--accent-rgb),.1);
            color:var(--accent);
            padding:.4rem .8rem;
            border-radius:.5rem;
            border:1px solid rgba(var(--accent-rgb),.3);
            display:inline-flex;
            align-items:center;
            gap:.5rem;
            font-size:.875rem;
        }
        .copy-coords{
            background:transparent;
            border:none;
            color:var(--accent);
            font-size:1rem;
            cursor:pointer;
        }
        .copy-coords:hover,
        .copy-coords:focus-visible{
            color:#fff;
        }

        .image{
            position:relative;
            margin:.75rem 0;
            cursor:pointer;
            border:2px solid #555;
            border-radius:.5rem;
            overflow:hidden;
        }
        .image img{
            width:100%;height:200px;object-fit:cover;
            transition:transform .3s;
        }
        .image:hover img,
        .image:focus-within img{transform:scale(1.05);}
        .overlay{
            position:absolute;inset:0;
            background:var(--bg-overlay);
            color:var(--text-primary);
            display:flex;align-items:center;justify-content:center;
            opacity:0;
            transition:opacity .3s;
        }
        .image:hover .overlay,
        .image:focus-within .overlay{opacity:1;}
        .overlay span{font-weight:bold;}

        .description{
            font-size:.9375rem;
            color:var(--text-secondary);
            margin:.75rem 0;
        }

        .players{
            margin-top:.75rem;
            padding-top:.75rem;
            border-top:1px solid var(--border);
        }
        .players-title{
            font-size:.9375rem;
            color:var(--accent);
            margin-bottom:.5rem;
        }
        .players-list{
            list-style:none;
            display:flex;
            flex-wrap:wrap;
            gap:.5rem;
        }
        .player-item{
            display:flex;
            align-items:center;
        }
        .player-avatar{
            width:24px;height:24px;
            border-radius:4px;
            margin-right:.5rem;
            flex-shrink:0;
        }
        .player-link{
            background:rgba(100,100,100,.5);
            color:var(--text-primary);
            padding:.4rem .75rem;
            border-radius:15px;
            text-decoration:none;
            font-size:.8125rem;
            border:1px solid #666;
            transition:background .3s,color .3s,border-color .3s;
        }
        .player-link:hover,
        .player-link:focus-visible{
            background:var(--accent);
            color:var(--bg-primary);
            border-color:var(--accent);
        }

        .no-results{
            grid-column:1 / -1;
            background:var(--bg-card);
            border:2px solid var(--border);
            border-radius:12px;
            padding:2rem;
            text-align:center;
            font-size:1.25rem;
            color:var(--accent);
        }

        /* -------------------- Lightbox -------------------- */
        .lightbox{
            display:none;
            position:fixed;
            inset:0;
            background:rgba(0,0,0,.9);
            z-index:1000;
            overflow:auto;
            padding-top:2rem;
        }
        .lightbox[aria-hidden="false"]{
            display:flex;
            justify-content:center;
            align-items:start;
        }
        .lb-content{
            position:relative;
            max-width:90%;
            width:800px;
        }
        .lb-content img{
            width:100%;
            height:auto;
            border-radius:.75rem;
            box-shadow:0 0 20px rgba(var(--accent-rgb),.3);
        }
        .close-btn{
            position:absolute;
            top:1rem;right:1rem;
            background:transparent;
            border:none;
            color:var(--text-primary);
            font-size:2rem;
            cursor:pointer;
            text-shadow:0 0 5px #000;
        }
        .close-btn:hover,
        .close-btn:focus-visible{color:var(--accent);}
        .nav{
            position:absolute;
            top:50%;transform:translateY(-50%);
            background:rgba(0,0,0,.5);
            color:#fff;
            border:none;
            padding:.75rem 1rem;
            font-size:1.25rem;
            cursor:pointer;
            border-radius:.3rem;
            transition:background.3s;
        }
        .nav:hover,
        .nav:focus-visible{background:rgba(var(--accent-rgb),.8);}
        .prev{left:1rem;}
        .next{right:1rem;}
        .counter{
            position:absolute;
            top:1rem;left:1rem;
            color:#fff;
            font-size:1rem;
            text-shadow:0 0 5px #000;
        }
        .thumbs{
            display:flex;
            gap:.5rem;
            margin-top:1rem;
            overflow-x:auto;
            padding:.5rem 0;
        }
        .thumb{
            width:60px;height:60px;
            border:2px solid transparent;
            border-radius:.3rem;
            overflow:hidden;
            cursor:pointer;
            transition:transform .3s,border-color .3s;
            flex-shrink:0;
        }
        .thumb:hover,
        .thumb:focus-visible,
        .thumb.active{
            border-color:var(--accent);
            transform:scale(1.08);
        }
        .thumb img{
            width:100%;height:100%;object-fit:cover;
        }

        /* -------------------- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å -------------------- */
        @media (max-width:768px){
            .grid{grid-template-columns:1fr;}
            header h1{font-size:2.2rem;}
            .card-header{flex-direction:column;text-align:center;}
            .icon{margin-right:0;margin-bottom:.5rem;}
            .controls{flex-direction:column;align-items:stretch;}
        }

        /* -------------------- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è -------------------- */
        @media (prefers-reduced-motion:reduce){
            *,*::before,*::after{transition:none!important;}
        }
        :focus-visible{
            outline:3px solid var(--focus);
            outline-offset:2px;
        }
    </style>
</head>
<body>
    <!-- ==================== –®–∞–ø–∫–∞ ==================== -->
    <header>
        <h1>–ü–û–°–¢–†–û–ô–ö–ò –°–ï–†–í–ï–†–ê</h1>
        <p>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!</p>
        <p>Zakap —Ç—É—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç</p>
        <p><img src="https://starlightskins.lunareclipse.studio/render/reading/zakap/full" alt="reading guides"></p>
        <p>–ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ JansickGD –≤ —Å–æ–∑–¥–∞–Ω–∏—è —Å–∞–π—Ç–∞</p>
    </header>

    <main class="container">
        <!-- ==================== –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ==================== -->
        <section class="controls" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º">
            <div class="stats">
                –í—Å–µ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–∫: <span id="total-count">0</span>
            </div>
            <nav class="filters" role="group" aria-label="–§–∏–ª—å—Ç—Ä—ã –ø–æ—Å—Ç—Ä–æ–µ–∫">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="castle">–ó–∞–º–∫–∏</button>
                <button class="filter-btn" data-filter="farm">–§–µ—Ä–º—ã</button>
                <button class="filter-btn" data-filter="other">–î—Ä—É–≥–æ–µ</button>
            </nav>
            <div class="search">
                <label for="search-input" class="visually-hidden">–ü–æ–∏—Å–∫ –ø–æ—Å—Ç—Ä–æ–µ–∫</label>
                <input type="search"
                       id="search-input"
                       placeholder="–ü–æ–∏—Å–∫ –ø–æ—Å—Ç—Ä–æ–µ–∫..."
                       autocomplete="off"
                       aria-label="–ü–æ–∏—Å–∫ –ø–æ—Å—Ç—Ä–æ–µ–∫">
            </div>
        </section>

        <!-- ==================== –°–µ—Ç–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–∫ ==================== -->
        <section id="buildings" class="grid" aria-live="polite"></section>

        <p id="no-results" class="no-results" hidden>–ï—â—ë –Ω–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ!</p>
    </main>

    <!-- ==================== Lightbox (–≥–∞–ª–µ—Ä–µ—è) ==================== -->
    <div id="lightbox"
         class="lightbox"
         role="dialog"
         aria-modal="true"
         aria-hidden="true"
         aria-label="–ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π">
        <button class="close-btn" aria-label="–ó–∞–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é">&times;</button>

        <div class="lb-content">
            <img id="lb-img" src="" alt="">
            <button class="nav prev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">&#9664;</button>
            <button class="nav next" aria-label="–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">&#9654;</button>
            <div class="counter" id="lb-counter"></div>
            <div class="thumbs" id="lb-thumbs"></div>
        </div>
    </div>

    <!-- ==================== JavaScript ==================== -->
    <script>
        /* ------------ –î–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—Ä–æ–µ–∫ ------------ */
        const buildings = [
            {
                name: "–ó–∞–º–æ–∫ –ê–ª–µ–∫—Å–∞",
                type: "castle",
                icon: "üè∞",
                coords: {x:1245, y:64, z:-342},
                description: "–í–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞–º–æ–∫ –∏–∑ –±–µ–ª–æ–≥–æ –∫–∞–º–Ω—è —Å –±–∞—à–Ω—è–º–∏ –∏ –æ–±–æ—Ä–æ–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å—Ç–µ–Ω–∞–º–∏. –ü–æ—Å—Ç—Ä–æ–µ–Ω –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º —Å—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤–æ–º —Å—Ç–∏–ª–µ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Ñ—ç–Ω—Ç–µ–∑–∏.",
                players: [
                    {name:"AlexMaster", link:"players/alex.html"},
                    {name:"SteveBuilder", link:"players/steve.html"}
                ],
                images: [
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ó–∞–º–æ–∫+–ê–ª–µ–∫—Å–∞+1",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ó–∞–º–æ–∫+–ê–ª–µ–∫—Å–∞+2",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ó–∞–º–æ–∫+–ê–ª–µ–∫—Å–∞+3",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ó–∞–º–æ–∫+–ê–ª–µ–∫—Å–∞+4",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ó–∞–º–æ–∫+–ê–ª–µ–∫—Å–∞+5"
                ]
            },
            {
                name: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–µ—Ä–º–∞",
                type: "farm",
                icon: "üåæ",
                coords: {x:1320, y:68, z:-280},
                description: "–ö–æ–º–ø–ª–µ–∫—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–µ—Ä–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –µ–¥—ã, –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∏ –æ–ø—ã—Ç–∞. –í–∫–ª—é—á–∞–µ—Ç —Ñ–µ—Ä–º—ã –º–æ–±–æ–≤, —Ä–∞—Å—Ç–µ–Ω–∏–π –∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö.",
                players: [
                    {name:"RedstoneExpert", link:"players/redstone.html"}
                ],
                images: [
                    "https://placehold.co/800x500/32CD32/000000?text=–ê–≤—Ç–æ—Ñ–µ—Ä–º–∞+1",
                    "https://placehold.co/800x500/32CD32/000000?text=–ê–≤—Ç–æ—Ñ–µ—Ä–º–∞+2",
                    "https://placehold.co/800x500/32CD32/000000?text=–ê–≤—Ç–æ—Ñ–µ—Ä–º–∞+3"
                ]
            },
            {
                name: "–ù–∏–∂–µ—Ä–∏–π—Å–∫–∞—è —à–∞—Ö—Ç–∞",
                type: "other",
                icon: "‚õèÔ∏è",
                coords: {x:1180, y:-42, z:-310},
                description: "–ì–∏–≥–∞–Ω—Ç—Å–∫–∞—è —à–∞—Ö—Ç–∞ –¥–ª—è –¥–æ–±—ã—á–∏ –∞–ª–º–∞–∑–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö —Ä–µ–¥–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤. –û—Å–≤–µ—â–µ–Ω–∞ –∫—Ä–∞—Å–Ω—ã–º–∏ —Ñ–∞–∫–µ–ª–∞–º–∏ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∞ –ª–∏—Ñ—Ç–æ–º.",
                players: [
                    {name:"DiamondMiner", link:"players/miner.html"}
                ],
                images: [
                    "https://placehold.co/800x500/2F4F4F/FFFFFF?text=–®–∞—Ö—Ç–∞+1",
                    "https://placehold.co/800x500/2F4F4F/FFFFFF?text=–®–∞—Ö—Ç–∞+2",
                    "https://placehold.co/800x500/2F4F4F/FFFFFF?text=–®–∞—Ö—Ç–∞+3",
                    "https://placehold.co/800x500/2F4F4F/FFFFFF?text=–®–∞—Ö—Ç–∞+4"
                ]
            },
            {
                name: "–ó–∞–º–æ–∫ –û–≥–Ω—è",
                type: "castle",
                icon: "üî•",
                coords: {x:-450, y:72, z:890},
                description: "–û–≥–Ω–µ–Ω–Ω—ã–π –∑–∞–º–æ–∫ –∏–∑ –Ω–µ–∑–µ—Ä–∏—Ç–∞ –∏ –æ–±—Å–∏–¥–∏–∞–Ω–∞. –û–∫—Ä—É–∂—ë–Ω –ª–∞–≤–æ–≤—ã–º–∏ —Ä–≤–∞–º–∏ –∏ —É–∫—Ä–∞—à–µ–Ω –æ–≥–Ω–µ–Ω–Ω—ã–º–∏ —Ñ–∞–∫–µ–ª–∞–º–∏.",
                players: [
                    {name:"FireWarrior", link:"players/fire.html"}
                ],
                images: [
                    "https://placehold.co/800x500/FF4500/000000?text=–ó–∞–º–æ–∫+–û–≥–Ω—è+1",
                    "https://placehold.co/800x500/FF4500/000000?text=–ó–∞–º–æ–∫+–û–≥–Ω—è+2",
                    "https://placehold.co/800x500/FF4500/000000?text=–ó–∞–º–æ–∫+–û–≥–Ω—è+3",
                    "https://placehold.co/800x500/FF4500/000000?text=–ó–∞–º–æ–∫+–û–≥–Ω—è+4",
                    "https://placehold.co/800x500/FF4500/000000?text=–ó–∞–º–æ–∫+–û–≥–Ω—è+5",
                    "https://placehold.co/800x500/FF4500/000000?text=–ó–∞–º–æ–∫+–û–≥–Ω—è+6"
                ]
            },
            {
                name: "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–Ω–∞–Ω–∏–π",
                type: "other",
                icon: "üìö",
                coords: {x:230, y:65, z:150},
                description: "–û–≥—Ä–æ–º–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å —Ç—ã—Å—è—á–∞–º–∏ –∫–Ω–∏–≥ –∏ –∫–∞—Ä—Ç. –ò–º–µ–µ—Ç —Å–∏—Å—Ç–µ–º—É –∫–∞—Ç–∞–ª–æ–≥–∏–∑–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—Ç–µ–∫–∏.",
                players: [
                    {name:"BookKeeper", link:"players/book.html"}
                ],
                images: [
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+1",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+2",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+3",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+4",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+5",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+6",
                    "https://placehold.co/800x500/8B4513/FFFFFF?text=–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞+7"
                ]
            },
            {
                name: "–§–µ—Ä–º–∞ –∂–∏–≤–æ—Ç–Ω—ã—Ö",
                type: "farm",
                icon: "üêÑ",
                coords: {x:560, y:68, z:-720},
                description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–µ—Ä–º–∞ –¥–ª—è —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –∂–∏–≤–æ—Ç–Ω—ã—Ö. –í–∫–ª—é—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è, —Å—Ç—Ä–∏–∂–∫–∏ –∏ —Å–±–æ—Ä–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏.",
                players: [
                    {name:"FarmBuilder", link:"players/farm.html"}
                ],
                images: [
                    "https://placehold.co/800x500/32CD32/000000?text=–§–µ—Ä–º–∞+–∂–∏–≤–æ—Ç–Ω—ã—Ö+1",
                    "https://placehold.co/800x500/32CD32/000000?text=–§–µ—Ä–º–∞+–∂–∏–≤–æ—Ç–Ω—ã—Ö+2",
                    "https://placehold.co/800x500/32CD32/000000?text=–§–µ—Ä–º–∞+–∂–∏–≤–æ—Ç–Ω—ã—Ö+3",
                    "https://placehold.co/800x500/32CD32/000000?text=–§–µ—Ä–º–∞+–∂–∏–≤–æ—Ç–Ω—ã—Ö+4"
                ]
            },
            {
                name: "–õ–µ–¥—è–Ω–æ–π –¥–≤–æ—Ä–µ—Ü",
                type: "castle",
                icon: "‚ùÑÔ∏è",
                coords: {x:-1200, y:85, z:-1500},
                description: "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π –¥–≤–æ—Ä–µ—Ü –∏–∑–æ –ª—å–¥–∞ –∏ —Å–Ω–µ–≥–∞. –ü–æ—Å—Ç—Ä–æ–µ–Ω –≤ –∞—Ä–∫—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–≥–∏–æ–Ω–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.",
                players: [
                    {name:"IceQueen", link:"players/ice.html"}
                ],
                images: [
                    "https://placehold.co/800x500/87CEEB/000000?text=–õ–µ–¥—è–Ω–æ–π+–¥–≤–æ—Ä–µ—Ü+1",
                    "https://placehold.co/800x500/87CEEB/000000?text=–õ–µ–¥—è–Ω–æ–π+–¥–≤–æ—Ä–µ—Ü+2",
                    "https://placehold.co/800x500/87CEEB/000000?text=–õ–µ–¥—è–Ω–æ–π+–¥–≤–æ—Ä–µ—Ü+3",
                    "https://placehold.co/800x500/87CEEB/000000?text=–õ–µ–¥—è–Ω–æ–π+–¥–≤–æ—Ä–µ—Ü+4",
                    "https://placehold.co/800x500/87CEEB/000000?text=–õ–µ–¥—è–Ω–æ–π+–¥–≤–æ—Ä–µ—Ü+5"
                ]
            },
            {
                name: "–ì–æ—Ä–æ–¥ –†–µ–¥—Å—Ç–æ—É–Ω",
                type: "other",
                icon: "‚öôÔ∏è",
                coords: {x:800, y:64, z:300},
                description: "–¶–µ–ª—ã–π –≥–æ—Ä–æ–¥ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏. –í–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–≤–µ—Ä–∏, –ª–∏—Ñ—Ç—ã, –æ—Å–≤–µ—â–µ–Ω–∏–µ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç.",
                players: [
                    {name:"RedstoneExpert", link:"players/redstone.html"},
                    {name:"ChiefEngineer", link:"players/engineer.html"}
                ],
                images: [
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+1",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+2",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+3",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+4",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+5",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+6",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+7",
                    "https://placehold.co/800x500/FFD700/000000?text=–†–µ–¥—Å—Ç–æ—É–Ω+–≥–æ—Ä–æ–¥+8"
                ]
            }
        ];

        /* ------------------- UI-—ç–ª–µ–º–µ–Ω—Ç—ã ------------------- */
        const grid           = document.getElementById('buildings');
        const totalCount     = document.getElementById('total-count');
        const searchInput    = document.getElementById('search-input');
        const filterBtns     = document.querySelectorAll('.filter-btn');
        const noResults      = document.getElementById('no-results');

        const lightbox       = document.getElementById('lightbox');
        const lbImg          = document.getElementById('lb-img');
        const lbCloseBtn     = lightbox.querySelector('.close-btn');
        const lbPrevBtn      = lightbox.querySelector('.prev');
        const lbNextBtn      = lightbox.querySelector('.next');
        const lbCounter      = document.getElementById('lb-counter');
        const lbThumbs       = document.getElementById('lb-thumbs');

        let currentBuilding = null;   // –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤–µ buildings
        let currentImgIdx   = 0;
        let activeFilter    = 'all';
        let debounceTimer   = null;

        /* ------------------- –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ ------------------- */
        function renderCards() {
            const frag = document.createDocumentFragment();

            buildings.forEach((b, i) => {
                const card = document.createElement('article');
                card.className = 'card';
                card.dataset.type  = b.type;
                card.dataset.name  = b.name;
                card.dataset.index = i;
                card.tabIndex = 0;

                /* Header (–∏–∫–æ–Ω–∫–∞ + –Ω–∞–∑–≤–∞–Ω–∏–µ) */
                const header = document.createElement('header');
                header.className = 'card-header';

                const icon = document.createElement('div');
                icon.className = 'icon';
                icon.setAttribute('aria-hidden','true');
                icon.textContent = b.icon;

                const title = document.createElement('h2');
                title.className = 'title';
                title.textContent = b.name;

                header.append(icon, title);
                card.appendChild(header);

                /* –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã + –∫–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å */
                const coords = document.createElement('div');
                coords.className = 'coords';

                const code = document.createElement('code');
                code.textContent = `x=${b.coords.x}, y=${b.coords.y}, z=${b.coords.z}`;
                coords.appendChild(code);

                const copyBtn = document.createElement('button');
                copyBtn.className = 'copy-coords';
                copyBtn.type = 'button';
                copyBtn.setAttribute('aria-label','–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã');
                copyBtn.textContent = '¬©';
                coords.appendChild(copyBtn);

                card.appendChild(coords);

                /* –û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Lightbox) */
                const figure = document.createElement('figure');
                figure.className = 'image';
                figure.tabIndex = 0;
                figure.setAttribute('role','button');
                figure.setAttribute('aria-label',`–û—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é ${b.name}`);
                figure.dataset.index = i;

                const img = document.createElement('img');
                img.src = b.images[0];
                img.alt = `${b.name} ‚Äì –ø—Ä–µ–≤—å—é`;
                img.loading = 'lazy';

                const overlay = document.createElement('div');
                overlay.className = 'overlay';
                overlay.innerHTML = `<span> ¬∫ ${b.images.length} —Ñ–æ—Ç–æ</span>`;

                figure.append(img, overlay);
                card.appendChild(figure);

                /* –û–ø–∏—Å–∞–Ω–∏–µ */
                const desc = document.createElement('p');
                desc.className = 'description';
                desc.textContent = b.description;
                card.appendChild(desc);

                /* –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ (–∞–≤–∞—Ç–∞—Ä–∫–∞ + –Ω–∏–∫) */
                const playersSec = document.createElement('section');
                playersSec.className = 'players';

                const playersTitle = document.createElement('h4');
                playersTitle.className = 'players-title';
                playersTitle.textContent = '–°–¢–†–û–ò–¢–ï–õ–ò:';
                playersSec.appendChild(playersTitle);

                const playersList = document.createElement('ul');
                playersList.className = 'players-list';

                b.players.forEach(p => {
                    const li = document.createElement('li');
                    li.className = 'player-item';

                    const avatar = document.createElement('img');
                    avatar.className = 'player-avatar';
                    avatar.src = `https://mineskin.eu/helm/${p.name.toLowerCase()}`;
                    avatar.alt = `${p.name} avatar`;

                    const link = document.createElement('a');
                    link.className = 'player-link';
                    link.href = p.link;
                    link.textContent = p.name;

                    li.append(avatar, link);
                    playersList.appendChild(li);
                });

                playersSec.appendChild(playersList);
                card.appendChild(playersSec);

                frag.appendChild(card);
            });

            grid.appendChild(frag);
            totalCount.textContent = buildings.length;
        }

        /* ------------------- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ ------------------- */
        function applyFilters() {
            const term = searchInput.value.trim().toLowerCase();
            let visible = 0;

            document.querySelectorAll('.card').forEach(card => {
                const typeMatch = activeFilter === 'all' || card.dataset.type === activeFilter;
                const name = card.dataset.name.toLowerCase();
                const desc = card.querySelector('.description').textContent.toLowerCase();
                const playerNames = Array.from(card.querySelectorAll('.player-link')).map(a=>a.textContent.toLowerCase());

                const textMatch = term === '' ||
                                  name.includes(term) ||
                                  desc.includes(term) ||
                                  playerNames.some(p=>p.includes(term));

                const show = typeMatch && textMatch;
                card.style.display = show ? '' : 'none';
                if (show) visible++;
            });

            totalCount.textContent = visible;
            noResults.hidden = visible !== 0;
        }

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                filterBtns.forEach(b=>b.classList.remove('active'));
                btn.classList.add('active');
                activeFilter = btn.dataset.filter;
                applyFilters();
            });
        });

        searchInput.addEventListener('input', () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(applyFilters, 250);
        });

        /* ------------------- Lightbox ------------------- */
        function openLightbox(buildingIdx) {
            currentBuilding = buildings[buildingIdx];
            currentImgIdx   = 0;
            updateLightbox();
            lightbox.setAttribute('aria-hidden','false');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            lightbox.setAttribute('aria-hidden','true');
            document.body.style.overflow = '';
        }

        function updateLightbox() {
            const src = currentBuilding.images[currentImgIdx];
            lbImg.src = src;
            lbImg.alt = `${currentBuilding.name} ${currentImgIdx+1}`;
            lbCounter.textContent = `${currentImgIdx+1} / ${currentBuilding.images.length}`;
            renderThumbs();
        }

        function renderThumbs() {
            lbThumbs.innerHTML = '';
            currentBuilding.images.forEach((src,i) => {
                const btn = document.createElement('button');
                btn.className = 'thumb' + (i===currentImgIdx ? ' active' : '');
                btn.type = 'button';
                btn.setAttribute('aria-label',`–ú–∏–Ω–∏–∞—Ç—é—Ä–∞ ${i+1}`);
                btn.innerHTML = `<img src="${src.replace('800x500','100x100')}" alt="–ú–∏–Ω–∏–∞—Ç—é—Ä–∞ ${i+1}">`;
                btn.addEventListener('click', () => {
                    currentImgIdx = i;
                    updateLightbox();
                });
                lbThumbs.appendChild(btn);
            });
        }

        function changeImg(step) {
            const total = currentBuilding.images.length;
            currentImgIdx = (currentImgIdx + step + total) % total;
            updateLightbox();
        }

        /* –ö–ª–∏–∫–∏ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö */
        grid.addEventListener('click', e => {
            const fig = e.target.closest('.image');
            if (fig) {
                openLightbox(Number(fig.dataset.index));
                return;
            }

            // –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
            if (e.target.classList.contains('copy-coords')) {
                const code = e.target.closest('.coords').querySelector('code');
                const txt = code.textContent;
                navigator.clipboard.writeText(txt).then(() => {
                    const original = e.target.textContent;
                    e.target.textContent = '‚úÖ';
                    setTimeout(() => e.target.textContent = original, 1500);
                }).catch(() => alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã'));
                e.stopPropagation();
            }
        });

        /* –û—Ç–∫—Ä—ã—Ç–∏–µ Lightbox –∫–ª–∞–≤–∏—à–∞–º–∏ Enter/Space */
        grid.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
                const fig = e.target.closest('.image');
                if (fig) {
                    openLightbox(Number(fig.dataset.index));
                    e.preventDefault();
                }
            }
        });

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Lightbox */
        lbCloseBtn.addEventListener('click', closeLightbox);
        lbPrevBtn.addEventListener('click', () => changeImg(-1));
        lbNextBtn.addEventListener('click', () => changeImg(1));

        document.addEventListener('keydown', e => {
            if (lightbox.getAttribute('aria-hidden') === 'false') {
                if (e.key === 'Escape') closeLightbox();
                if (e.key === 'ArrowLeft')  changeImg(-1);
                if (e.key === 'ArrowRight') changeImg(1);
            }
        });

        lightbox.addEventListener('click', e => {
            if (e.target === lightbox) closeLightbox();
        });

        /* ------------------- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ------------------- */
        document.addEventListener('DOMContentLoaded', () => {
            renderCards();
            // –Ω–µ–±–æ–ª—å—à–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
            document.querySelectorAll('.card').forEach((c,i) => {
                c.style.opacity = 0;
                c.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    c.style.transition = 'all .5s ease';
                    c.style.opacity = 1;
                    c.style.transform = 'translateY(0)';
                }, i * 100);
            });
        });
    </script>
</body>
</html>
